window.__require=function t(n,e,i){function s(o,c){if(!e[o]){if(!n[o]){var r=o.split("/");if(r=r[r.length-1],!n[r]){var u="function"==typeof __require&&__require;if(!c&&u)return u(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+o+"'")}o=r}var l=e[o]={exports:{}};n[o][0].call(l.exports,function(t){return s(n[o][1][t]||t)},l,l.exports,t,n,e,i)}return e[o].exports}for(var a="function"==typeof __require&&__require,o=0;o<i.length;o++)s(i[o]);return s}({Controller:[function(t,n,e){"use strict";cc._RF.push(n,"f836dKWNtlCD4eB7ehfDQhA","Controller");var i=cc.Class({statics:{_instance:null,getInstance:function(){return i._instance||(i._instance=new i,i._instance.init()),i._instance}},properties:{initJson:null,streamJson:null,loadIndex:0,gameStatus:!1},init:function(){},getInitStageData:function(){return this.initJson.stage},getInitPlayerData:function(){return this.initJson.player},getCommandLine:function(t){var n=this.streamJson;return null==n?-1:t>=n.data.length?(console.log("Out of Range"),-1):n.data[t]},getCommandLength:function(){return this.streamJson.data.length-1},ReceiveJson:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.initJson=t:this.streamJson=t},GetProgressId:function(){return this.loadIndex},SetProgressId:function(t){this.loadIndex=t},GetStatus:function(){return this.gameStatus},SetStatus:function(t){this.gameStatus=t}});n.exports=i,window.SendInitData=function(t){return null!=i.getInstance().initJson||(i.getInstance().ReceiveJson(t,!0),!1)},window.SendStreamData=function(t){i.getInstance().ReceiveJson(t),i.getInstance().SetProgressId(0),i.getInstance().SetStatus(!0)},window.TestFunc=function(){console.log("FUCK")},window.SetProgressId=function(t){i.getInstance().SetProgressId(t)},window.OnClickPlay=function(){i.getInstance().SetStatus(!0)},cc._RF.pop()},{}],Env:[function(t,n,e){"use strict";cc._RF.push(n,"79616xg/o1EEq25k+q+RW23","Env"),window.Env={OFFSET_X:96,OFFSET_Y:96,PLAYER_RADIO:48,DUMMY_TYPE_FOOD:1,DUMMY_TYPE_ROCKET_PARTS:2,DUMMY_TYPE_SOLID_OIL:3,DUMMY_TYPE_OIL:4,DUMMY_TYPE_ENGINE:5,DUMMY_TYPE_O2:6,DUMMY_TYPE_HEALPACK:7,DUMMY_TYPE_BOMB:8,DUMMY_RAISER_SWITCH:9,DUMMY_TYPE_RAISER_START:10,DUMMY_TYPE_RAISER_MIDDLE:11,DUMMY_TYPE_RAISER_END:12,DUMMY_TYPE_DROP_SWITCH:13,DUMMY_TYPE_DROP_ITEM:14,DIRECTION_UP:"up",DIRECTION_LEFT:"left",DIRECTION_RIGHT:"right",DIRECTION_DOWN:"down",TAG_DISABLE_BLOCK:0,TAG_ALLOW_BLOCK:1,TAG_PLAYER:1,TAG_GOAL:2},cc._RF.pop()},{}],GameDummy:[function(t,n,e){"use strict";cc._RF.push(n,"fcd81NpxC9N7pbIShIJfJLS","GameDummy");t("Controller"),cc.Class({extends:cc.Component,properties:{initPosition:null,dummyType:null,dummyStatus:null},ctor:function(t,n){this.dummyType=t,this.initPosition=n,this.init()},init:function(){this.dummyStatus=Env.DUMMY_INIT,this.node.setPosition(this.initPosition),this.dummyStatus=Env.DUMMY_LIVE},collision:function(){this.dummyStatus=Env.DUMMY_DESTORY,this.node.active=!1},getStatus:function(){return this.dummyStatus},getDuumyType:function(){return this.dummyType}});cc._RF.pop()},{Controller:"Controller"}],GameItem:[function(t,n,e){"use strict";cc._RF.push(n,"3b57b/k2o5A74/oXmoaRZHF","GameItem");var i=t("GameDummy");cc.Class({extends:i,properties:{},ctor:function(t,n){this.dummyType=t,this.init(),this.initPosition=n},Init:function(){this.init()},Collision:function(){this.collision()}});cc._RF.pop()},{GameDummy:"GameDummy"}],GameManager:[function(t,n,e){"use strict";cc._RF.push(n,"727210ZU8hOIIDBp99LB0z6","GameManager");var i=t("../Controller");cc.Class({extends:cc.Component,properties:{isPlay:!1,camera:cc.Camera,mapOffset:{default:[],type:[cc.Vec2]},mapSize:{default:null,type:cc.Vec2},idx:0,btnCase1:cc.Button,btnCase2:cc.Button,btnCase3:cc.Button,btnRestart:cc.Button,btnGo:cc.Button,btnTest:cc.Button,btnMapChange:cc.Button,gameMap:cc.TiledMap,player:cc.Node},onLoad:function(){this.InitGame(),this.AddEvent()},AddEvent:function(){this.btnTest.node.on("click",this.TestFunction,this),this.btnGo.node.on("click",this.TestGoPlayer,this),this.btnMapChange.node.on("click",this.TestChangeMap,this),this.btnCase1.node.on("click",this.TestCase1,this),this.btnCase2.node.on("click",this.TestCase2,this),this.btnCase3.node.on("click",this.TestCase3,this)},InitGame:function(){this.mapOffset=[{x:0,y:2},{x:2,y:3}],this.loadInit()},loadInit:function(){var t=this,n=setInterval(function(){null!=i.getInstance().initJson?(t.InitMap(),t.InitPlayer(),t.SetCamera(),clearInterval(n)):console.log("Loading")},100)},gamesSchedule:function(){},update:function(t){i.getInstance().GetStatus()&&this.OnCodePlay()},InitPlayer:function(){var t=i.getInstance().getInitPlayerData(),n=t.pos,e=t.dir,s=(t.hp,t.status,t.food_count,t.rocket_parts_count,this),a=this.GVector(n[0],n[1]);cc.loader.loadRes("./prefabs/Player",cc.Prefab,function(t,n){t?cc.error("Error loading image: "+t):(s.player=cc.instantiate(n),s.player.getComponent("Player").Init(a,e),s.node.addChild(s.player))})},GVector:function(t,n){var e=i.getInstance().getInitStageData(),s=e.map,a=e.step,o=e.diff,c=e.level,r=0;1==s&&0==a&&0==o&&(r=c);i.getInstance().getInitPlayerData().pos;return cc.v2((t+this.mapOffset[r].x)*Env.OFFSET_X+Env.PLAYER_RADIO,(n+this.mapOffset[r].y)*Env.OFFSET_Y+Env.PLAYER_RADIO)},InitMap:function(){var t=this,n="./map/"+this.GetMapURL();cc.loader.loadRes(n,cc.TiledMapAsset,function(n,e){if(n)cc.error("Error loading image: "+n);else{t.gameMap.tmxAsset=e;var i=t.gameMap.getMapSize(),s=t.gameMap.getTileSize(),a=i.width*s.width,o=i.height*s.height,c=cc.v2(a,o);t.mapSize=c,t.SetCamera(c.x,c.y)}})},_IsTutorial:function(t,n,e){if(0==n&&0==e)return!0},GetMapURL:function(){var t="",n=i.getInstance().getInitStageData(),e=n.map,s=n.step,a=n.diff,o=n.level+1;if(this._IsTutorial(e,s,a))t="map_T-"+o.toString();else{var c="E";switch(o){case 1:c="E";break;case 2:c="N";break;case 3:c="H"}t="map_"+e.toString()+"-"+s.toString()+"-"+a.toString()+"-"+c}return t},SetCamera:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=cc.Canvas.instance.designResolution,i=(cc.view.getViewportRect(),-(e.width/2-t)),s=-(e.height/2-n);this.camera.node.setPosition(cc.v3(i,s,0))},FollowCamera:function(t){},InitObject:function(){},excuteCommand:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=i.getInstance().getCommandLine(t);if(-1==n)return!1;if(1==n.status)return!1;var e=this.GVector(n.player.pos[0],n.player.pos[1]);return this.player.getComponent("Player").setDirection(n.player.dir),this.player.getComponent("Player").Movement(e),!0},OnCodePlay:function(){if(!this.isPlay){var t=this;this.isPlay=!0,this.idx=i.getInstance().GetProgressId();var n=setInterval(function(){0==t.excuteCommand(t.idx)&&(clearInterval(n),t.isPlay=!1,i.getInstance().SetStatus(!1)),t.idx++},1e3/30)}},TestFunction:function(){this.player.getComponent("Player").playerInit()},TestGoPlayer:function(){if(!this.isPlay){this.idx=0;var t=this,n=setInterval(function(){t.isPlay=!0,0==t.excuteCommand(t.idx)&&(clearInterval(n),t.isPlay=!1),t.idx++},1e3/30)}},TestAddData:function(){this.player.getComponent("Player").Turn(Env.DIRECTION_RIGHT)},TestCase1:function(){i.getInstance().changeData(0)},TestCase2:function(){i.getInstance().changeData(1)},TestCase3:function(){i.getInstance().changeData(2)},TestChangeMap:function(){var t=cc.find("Canvas/Main Camera"),n=t.getPosition();console.log(n);var e=n.add(cc.v3(-1,0,0));console.log(e),t.setPosition(e)}}),cc._RF.pop()},{"../Controller":"Controller"}],GameRaiser:[function(t,n,e){"use strict";cc._RF.push(n,"a7bfaJjLTlAzK9olkIOIStK","GameRaiser");var i=t("GameDummy");cc.Class({extends:i,properties:{raiser_status:!1,match_id:0},ctor:function(t,n,e){this.dummyType=t,this.init(),this.initPosition=n,this.match_id=e},Init:function(){this.init()},Collision:function(){this.dummyType==Env.DUMMY_SWITCH?this.ChangeStauts():this.Raiser()},ChangeStauts:function(){this.raiser_status=!this.raiser_status},Raiser:function(){return!this.raiser_status}}),cc._RF.pop()},{GameDummy:"GameDummy"}],GameTrap:[function(t,n,e){"use strict";cc._RF.push(n,"8bc39c65GBCwJJ2TshD7rpe","GameTrap");var i=t("GameDummy");cc.Class({extends:i,properties:{},ctor:function(t,n){this.dummyType=t,this.init(),this.initPosition=n},Init:function(){this.init()},Collision:function(){this.collision()}});cc._RF.pop()},{GameDummy:"GameDummy"}],Player:[function(t,n,e){"use strict";cc._RF.push(n,"46be6eeiGlMCpDkX0lZkvE+","Player");t("Controller");cc.Class({extends:cc.Component,properties:{initPosition:null,destPostion:null,isMoving:!1,moveOffset:Env.OFFSET_X,moveDuration:1,direction:Env.DIRECTION_UP,distancePerFrame:0,nextPosition:0},start:function(){},Movement:function(t){this.changeSpriteDirection(),this.node.setPosition(t)},changeSpriteDirection:function(){switch(this.direction){case Env.DIRECTION_UP:this.node.scale=cc.v2(1,-1);break;case Env.DIRECTION_DOWN:case Env.DIRECTION_RIGHT:this.node.scale=cc.v2(-1,1);break;case Env.DIRECTION_LEFT:this.node.scale=cc.v2(1,1)}},Init:function(t,n){this.initPosition=t,this.node.setPosition(t)},playerInit:function(){this.node.setPosition(this.initPosition),this.direction=Env.DIRECTION_RIGHT,this.changeSpriteDirection()},setDirection:function(t){this.direction=t}}),cc._RF.pop()},{Controller:"Controller"}]},{},["Controller","Env","GameManager","GameDummy","GameItem","GameRaiser","GameTrap","Player"]);
//# sourceMappingURL=project.js.map
